import math

import matplotlib.pyplot as plt
import numpy as np
from matplotlib.colors import ListedColormap, BoundaryNorm


def plot_confusion_matrix(confusion_mat):
    fig, ax = plt.subplots(1, 1, figsize=(5, 5), dpi=80)
    # bounds = [0, 50, 100, 500, 5000, 10000, 40000]
    # colors = ['#33CC99', '#33CC66', '#33CC33', '#33CC00', '#3399FF', '#3399CC']
    bounds = [0, 10, 100, 500, 5000, 10000, 40000]
    colors = ['#33CC99', '#33CC66', '#33CC33', '#33CC00', '#3399FF', '#3399CC']
    cmap = ListedColormap(colors)
    norms = BoundaryNorm(bounds, cmap.N)
    plt.imshow(confusion_mat, cmap=cmap, norm=norms)
    plt.colorbar()
    plt.title('Confusion Matrix(RandomForest, star)')
    labels = ['35', '50', '60', '70', '85']
    tick_marks = np.arange(len(labels))
    plt.xticks(tick_marks, labels)
    plt.yticks(tick_marks, labels)
    plt.ylabel('True Label')
    plt.xlabel('Predicted Label')
    plt.savefig("../data/res/img/CM_RFC_credit.png")
    plt.show()


if __name__ == '__main__':
    # star
    # cm = np.array([[31686, 365, 86, 8, 8, 0, 0, 1, 1],
    #                [4391, 6415, 389, 14, 10, 0, 0, 3, 0],
    #                [363, 942, 7921, 253, 24, 11, 1, 6, 1],
    #                [6, 45, 1344, 949, 141, 9, 2, 17, 2],
    #                [1, 3, 179, 1027, 403, 87, 2, 17, 1],
    #                [0, 1, 60, 83, 476, 252, 4, 11, 3],
    #                [0, 0, 3, 0, 2, 5, 0, 0, 0],
    #                [0, 0, 2, 0, 0, 2, 0, 0, 0],
    #                [0, 0, 0, 0, 0, 0, 0, 0, 0]])
    # cm = np.array([[24463, 4083, 3478, 0, 77, 43, 4, 166, 3],
    #                [465, 1989, 7567, 3, 545, 429, 8, 202, 2],
    #                [53, 310, 6714, 0, 1855, 414, 5, 91, 1],
    #                [5, 39, 1469, 2, 771, 169, 3, 13, 3],
    #                [7, 12, 870, 2, 592, 214, 1, 11, 2],
    #                [2, 7, 333, 1, 365, 155, 2, 1, 0],
    #                [0, 0, 5, 0, 3, 4, 0, 0, 0],
    #                [0, 0, 1, 0, 0, 3, 0, 1, 0],
    #                [0, 0, 0, 0, 0, 0, 0, 0, 0]])
    # cm = np.array([[31868, 202, 84, 15, 4, 2, 0, 26, 5],
    #                [9397, 1404, 237, 26, 2, 4, 1, 42, 9],
    #                [1717, 3314, 3892, 350, 30, 13, 2, 143, 9],
    #                [10, 66, 1285, 931, 41, 11, 1, 145, 8],
    #                [1, 5, 157, 1123, 123, 40, 6, 357, 29],
    #                [2, 0, 5, 123, 142, 63, 18, 498, 34],
    #                [0, 0, 0, 0, 0, 0, 1, 6, 2],
    #                [0, 0, 0, 0, 0, 0, 2, 3, 2],
    #                [0, 0, 0, 0, 0, 0, 0, 0, 0]])
    # cm = np.array([[31614, 547, 43, 0, 1, 1, 0, 0],
    #                [2638, 7995, 488, 0, 1, 0, 0, 0],
    #                [30, 456, 8402, 566, 13, 3, 0, 0],
    #                [11, 0, 831, 1043, 593, 20, 0, 0],
    #                [1, 0, 11, 329, 1142, 357, 1, 0],
    #                [2, 0, 1, 0, 109, 773, 0, 0],
    #                [0, 0, 0, 0, 0, 9, 0, 0],
    #                [0, 0, 0, 0, 0, 7, 0, 0]])
    # cm = np.array([[30577, 1378, 250, 0, 1, 0, 0, 0],
    #                [2362, 7982, 774, 0, 4, 0, 0, 0],
    #                [394, 844, 8209, 0, 23, 0, 0, 0],
    #                [56, 47, 2210, 4, 177, 4, 0, 0],
    #                [18, 17, 1226, 0, 527, 53, 0, 0],
    #                [8, 5, 420, 0, 306, 146, 0, 0],
    #                [0, 0, 5, 0, 2, 2, 0, 0],
    #                [0, 1, 1, 0, 0, 5, 0, 0]])
    # credit
    # cm = np.array([[0, 0, 1, 0, 0],
    #                [0, 0, 24, 2, 0],
    #                [0, 0, 4661, 18, 0],
    #                [0, 0, 1968, 19, 0],
    #                [0, 0, 926, 8, 0]])
    # cm = np.array([[0, 0, 2, 0, 0],
    #                [0, 0, 18, 1, 0],
    #                [0, 1, 4665, 69, 0],
    #                [0, 1, 1913, 34, 1],
    #                [0, 1, 906, 13, 2]])
    # cm = np.array([[1, 0, 1, 0, 0],
    #                [16, 4, 17, 1, 0],
    #                [2050, 175, 2335, 91, 47],
    #                [1458, 85, 369, 26, 20],
    #                [726, 34, 148, 15, 8]])
    # cm = np.array([[0, 0, 2, 0, 0],
    #                [0, 0, 38, 0, 0],
    #                [0, 0, 4667, 31, 0],
    #                [0, 0, 1936, 22, 0],
    #                [0, 0, 917, 14, 0]])
    cm = np.array([[0, 0, 2, 0, 0],
                   [0, 0, 36, 2, 0],
                   [0, 0, 4681, 17, 0],
                   [0, 0, 1937, 21, 0],
                   [0, 0, 918, 13, 0]])
    plot_confusion_matrix(cm)
